{"version":"tree-0.1","tree":{"id":"App","path":"","constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.202.0"},"children":{"DataLakeAIAgentStack":{"id":"DataLakeAIAgentStack","path":"DataLakeAIAgentStack","constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.202.0"},"children":{"RawDataBucket":{"id":"RawDataBucket","path":"DataLakeAIAgentStack/RawDataBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/RawDataBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"DataLakeAIAgentStack/RawDataBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/RawDataBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"RawDataBucket57F26C03"},"policyDocument":{"Statement":[{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["RawDataBucket57F26C03","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["RawDataBucket57F26C03","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"DataLakeAIAgentStack/RawDataBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"DataLakeAIAgentStack/RawDataBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}}}},"LatestNodeRuntimeMap":{"id":"LatestNodeRuntimeMap","path":"DataLakeAIAgentStack/LatestNodeRuntimeMap","constructInfo":{"fqn":"aws-cdk-lib.CfnMapping","version":"2.202.0"}},"Custom::S3AutoDeleteObjectsCustomResourceProvider":{"id":"Custom::S3AutoDeleteObjectsCustomResourceProvider","path":"DataLakeAIAgentStack/Custom::S3AutoDeleteObjectsCustomResourceProvider","constructInfo":{"fqn":"aws-cdk-lib.CustomResourceProviderBase","version":"2.202.0"},"children":{"Staging":{"id":"Staging","path":"DataLakeAIAgentStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Staging","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.202.0"}},"Role":{"id":"Role","path":"DataLakeAIAgentStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Role","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}},"Handler":{"id":"Handler","path":"DataLakeAIAgentStack/Custom::S3AutoDeleteObjectsCustomResourceProvider/Handler","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}},"ProcessedDataBucket":{"id":"ProcessedDataBucket","path":"DataLakeAIAgentStack/ProcessedDataBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.Bucket","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/ProcessedDataBucket/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucket","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::Bucket","aws:cdk:cloudformation:props":{"tags":[{"key":"aws-cdk:auto-delete-objects","value":"true"}]}}},"Policy":{"id":"Policy","path":"DataLakeAIAgentStack/ProcessedDataBucket/Policy","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketPolicy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/ProcessedDataBucket/Policy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.CfnBucketPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::S3::BucketPolicy","aws:cdk:cloudformation:props":{"bucket":{"Ref":"ProcessedDataBucket4E25D3B7"},"policyDocument":{"Statement":[{"Action":["s3:PutBucketPolicy","s3:GetBucket*","s3:List*","s3:DeleteObject*"],"Effect":"Allow","Principal":{"AWS":{"Fn::GetAtt":["CustomS3AutoDeleteObjectsCustomResourceProviderRole3B1BD092","Arn"]}},"Resource":[{"Fn::GetAtt":["ProcessedDataBucket4E25D3B7","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ProcessedDataBucket4E25D3B7","Arn"]},"/*"]]}]}],"Version":"2012-10-17"}}}}}},"AutoDeleteObjectsCustomResource":{"id":"AutoDeleteObjectsCustomResource","path":"DataLakeAIAgentStack/ProcessedDataBucket/AutoDeleteObjectsCustomResource","constructInfo":{"fqn":"aws-cdk-lib.CustomResource","version":"2.202.0","metadata":[]},"children":{"Default":{"id":"Default","path":"DataLakeAIAgentStack/ProcessedDataBucket/AutoDeleteObjectsCustomResource/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}}}}}},"GlueDatabase":{"id":"GlueDatabase","path":"DataLakeAIAgentStack/GlueDatabase","constructInfo":{"fqn":"aws-cdk-lib.aws_glue.CfnDatabase","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Glue::Database","aws:cdk:cloudformation:props":{"catalogId":{"Ref":"AWS::AccountId"},"databaseInput":{"name":"processed_data_db","description":"Database for processed data"}}}},"GlueCrawlerRole":{"id":"GlueCrawlerRole","path":"DataLakeAIAgentStack/GlueCrawlerRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.202.0","metadata":[]},"children":{"ImportGlueCrawlerRole":{"id":"ImportGlueCrawlerRole","path":"DataLakeAIAgentStack/GlueCrawlerRole/ImportGlueCrawlerRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.202.0","metadata":[]}},"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/GlueCrawlerRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"glue.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSGlueServiceRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DataLakeAIAgentStack/GlueCrawlerRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/GlueCrawlerRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["RawDataBucket57F26C03","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["RawDataBucket57F26C03","Arn"]},"/*"]]}]},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ProcessedDataBucket4E25D3B7","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ProcessedDataBucket4E25D3B7","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"GlueCrawlerRoleDefaultPolicy44958AC9","roles":[{"Ref":"GlueCrawlerRole4AA4B387"}]}}}}}}},"GlueCrawler":{"id":"GlueCrawler","path":"DataLakeAIAgentStack/GlueCrawler","constructInfo":{"fqn":"aws-cdk-lib.aws_glue.CfnCrawler","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Glue::Crawler","aws:cdk:cloudformation:props":{"databaseName":{"Ref":"GlueDatabase"},"name":"user-data-crawler","role":{"Fn::GetAtt":["GlueCrawlerRole4AA4B387","Arn"]},"targets":{"s3Targets":[{"path":{"Fn::Join":["",["s3://",{"Ref":"RawDataBucket57F26C03"},"/raw_data/"]]}}]}}}},"GlueJobRole":{"id":"GlueJobRole","path":"DataLakeAIAgentStack/GlueJobRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.202.0","metadata":[]},"children":{"ImportGlueJobRole":{"id":"ImportGlueJobRole","path":"DataLakeAIAgentStack/GlueJobRole/ImportGlueJobRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.202.0","metadata":[]}},"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/GlueJobRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"glue.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSGlueServiceRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DataLakeAIAgentStack/GlueJobRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/GlueJobRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["RawDataBucket57F26C03","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["RawDataBucket57F26C03","Arn"]},"/*"]]}]},{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ProcessedDataBucket4E25D3B7","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ProcessedDataBucket4E25D3B7","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"GlueJobRoleDefaultPolicy94EFA0CF","roles":[{"Ref":"GlueJobRoleF1B69418"}]}}}}}}},"DataPuraVidaLoad":{"id":"DataPuraVidaLoad","path":"DataLakeAIAgentStack/DataPuraVidaLoad","constructInfo":{"fqn":"aws-cdk-lib.aws_glue.CfnJob","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Glue::Job","aws:cdk:cloudformation:props":{"command":{"name":"glueetl","scriptLocation":{"Fn::Join":["",["s3://",{"Ref":"ProcessedDataBucket4E25D3B7"},"/scripts/glue_script.py"]]},"pythonVersion":"3"},"defaultArguments":{"--TempDir":{"Fn::Join":["",["s3://",{"Ref":"ProcessedDataBucket4E25D3B7"},"/temp/"]]},"--job-language":"python","--job-bookmark-option":"job-bookmark-enable","--input_bucket":{"Ref":"RawDataBucket57F26C03"},"--output_bucket":{"Ref":"ProcessedDataBucket4E25D3B7"}},"glueVersion":"3.0","name":"data-pura-vida-load","role":{"Fn::GetAtt":["GlueJobRoleF1B69418","Arn"]}}}},"AIAgentFunction":{"id":"AIAgentFunction","path":"DataLakeAIAgentStack/AIAgentFunction","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.Function","version":"2.202.0","metadata":[]},"children":{"ServiceRole":{"id":"ServiceRole","path":"DataLakeAIAgentStack/AIAgentFunction/ServiceRole","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.202.0","metadata":[]},"children":{"ImportServiceRole":{"id":"ImportServiceRole","path":"DataLakeAIAgentStack/AIAgentFunction/ServiceRole/ImportServiceRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.202.0","metadata":[]}},"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/AIAgentFunction/ServiceRole/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"lambda.amazonaws.com"}}],"Version":"2012-10-17"},"managedPolicyArns":[{"Fn::Join":["",["arn:",{"Ref":"AWS::Partition"},":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"]]}]}}},"DefaultPolicy":{"id":"DefaultPolicy","path":"DataLakeAIAgentStack/AIAgentFunction/ServiceRole/DefaultPolicy","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/AIAgentFunction/ServiceRole/DefaultPolicy/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["s3:GetObject*","s3:GetBucket*","s3:List*","s3:DeleteObject*","s3:PutObject","s3:PutObjectLegalHold","s3:PutObjectRetention","s3:PutObjectTagging","s3:PutObjectVersionTagging","s3:Abort*"],"Effect":"Allow","Resource":[{"Fn::GetAtt":["ProcessedDataBucket4E25D3B7","Arn"]},{"Fn::Join":["",[{"Fn::GetAtt":["ProcessedDataBucket4E25D3B7","Arn"]},"/*"]]}]}],"Version":"2012-10-17"},"policyName":"AIAgentFunctionServiceRoleDefaultPolicyB3CCCB93","roles":[{"Ref":"AIAgentFunctionServiceRoleA4135E6F"}]}}}}}}},"Code":{"id":"Code","path":"DataLakeAIAgentStack/AIAgentFunction/Code","constructInfo":{"fqn":"aws-cdk-lib.aws_s3_assets.Asset","version":"2.202.0"},"children":{"Stage":{"id":"Stage","path":"DataLakeAIAgentStack/AIAgentFunction/Code/Stage","constructInfo":{"fqn":"aws-cdk-lib.AssetStaging","version":"2.202.0"}},"AssetBucket":{"id":"AssetBucket","path":"DataLakeAIAgentStack/AIAgentFunction/Code/AssetBucket","constructInfo":{"fqn":"aws-cdk-lib.aws_s3.BucketBase","version":"2.202.0","metadata":[]}}}},"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/AIAgentFunction/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnFunction","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Function","aws:cdk:cloudformation:props":{"code":{"s3Bucket":{"Fn::Sub":"cdk-hnb659fds-assets-${AWS::AccountId}-${AWS::Region}"},"s3Key":"947de7a3b761293b81a2785cd0fb123543cf910656abdfcf997cdcace9fc3177.zip"},"environment":{"variables":{"PROCESSED_DATA_BUCKET":{"Ref":"ProcessedDataBucket4E25D3B7"}}},"handler":"ai_agent.handler","role":{"Fn::GetAtt":["AIAgentFunctionServiceRoleA4135E6F","Arn"]},"runtime":"python3.9"}}}}},"GlueJobCompletionRule":{"id":"GlueJobCompletionRule","path":"DataLakeAIAgentStack/GlueJobCompletionRule","constructInfo":{"fqn":"aws-cdk-lib.aws_events.Rule","version":"2.202.0","metadata":[]},"children":{"Resource":{"id":"Resource","path":"DataLakeAIAgentStack/GlueJobCompletionRule/Resource","constructInfo":{"fqn":"aws-cdk-lib.aws_events.CfnRule","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Events::Rule","aws:cdk:cloudformation:props":{"eventPattern":{"detail":{"jobName":[{"Ref":"DataPuraVidaLoad"}],"state":["SUCCEEDED"]},"detail-type":["Glue Job State Change"],"source":["aws.glue"]},"state":"ENABLED","targets":[{"id":"Target0","arn":{"Fn::GetAtt":["AIAgentFunction739AD057","Arn"]}}]}}},"AllowEventRuleDataLakeAIAgentStackAIAgentFunction55BB5904":{"id":"AllowEventRuleDataLakeAIAgentStackAIAgentFunction55BB5904","path":"DataLakeAIAgentStack/GlueJobCompletionRule/AllowEventRuleDataLakeAIAgentStackAIAgentFunction55BB5904","constructInfo":{"fqn":"aws-cdk-lib.aws_lambda.CfnPermission","version":"2.202.0"},"attributes":{"aws:cdk:cloudformation:type":"AWS::Lambda::Permission","aws:cdk:cloudformation:props":{"action":"lambda:InvokeFunction","functionName":{"Fn::GetAtt":["AIAgentFunction739AD057","Arn"]},"principal":"events.amazonaws.com","sourceArn":{"Fn::GetAtt":["GlueJobCompletionRule20DB8F3C","Arn"]}}}}}},"CDKMetadata":{"id":"CDKMetadata","path":"DataLakeAIAgentStack/CDKMetadata","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"},"children":{"Default":{"id":"Default","path":"DataLakeAIAgentStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.202.0"}},"Condition":{"id":"Condition","path":"DataLakeAIAgentStack/CDKMetadata/Condition","constructInfo":{"fqn":"aws-cdk-lib.CfnCondition","version":"2.202.0"}}}},"BootstrapVersion":{"id":"BootstrapVersion","path":"DataLakeAIAgentStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.202.0"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"DataLakeAIAgentStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.202.0"}}}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}}}}